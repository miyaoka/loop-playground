<!doctype html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Loop Animation - Web Component</title>
    <script type="module" src="./loop-scroll.js"></script>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: system-ui, sans-serif;
        padding: 40px;
        background: #f5f5f5;
      }

      .header {
        display: flex;
        align-items: center;
        gap: 20px;
        margin-bottom: 20px;
      }

      .header h1 {
        margin: 0;
      }

      .header-nav {
        display: flex;
        gap: 16px;
      }

      .header-nav a.active {
        color: inherit;
        text-decoration: none;
      }

      .header-menu {
        display: flex;
        gap: 10px;
      }

      .header-menu button {
        padding: 8px 16px;
        border: 1px solid #ddd;
        border-radius: 4px;
        background: #fff;
        cursor: pointer;
      }

      .header-menu button.active {
        background: #667eea;
        color: white;
        border-color: #667eea;
      }

      h2 {
        margin: 30px 0 10px;
      }

      /* loop-scrollのスタイル */
      loop-scroll {
        display: flex;
        width: var(--loop-width, 100%);
        max-width: 100%;
        overflow: hidden;
        position: relative;
        background: #fff;
        border: 1px solid #ddd;
        border-radius: 8px;
        margin-bottom: 20px;
      }

      loop-scroll:hover .loop-track {
        animation-play-state: paused;
      }

      @keyframes scroll {
        0% {
          transform: translateX(0);
        }
        100% {
          transform: translateX(-100%);
        }
      }

      /* デバッグ用：fill用クローンをグレースケールで表示 */
      .debug [data-fill-clone] {
        filter: grayscale(1);
        opacity: 0.8;
      }

      /* デバッグ用：loop-clone内の要素をグレースケール+薄く表示 */
      .debug .loop-clone .item {
        opacity: 0.5;
      }

      /* アイテムのスタイル */
      .item {
        flex-shrink: 0;
        padding: 20px 40px;
        margin: 10px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border-radius: 8px;
        font-weight: bold;
        white-space: nowrap;
      }

      button.item {
        border: none;
        cursor: pointer;
      }
    </style>
  </head>
  <body class="debug">
    <div class="header">
      <h1>Loop Animation - Web Component版</h1>
      <nav class="header-nav">
        <a href="index.html">通常版</a>
        <a href="webcomponent.html" class="active">Web Component版</a>
      </nav>
      <div class="header-menu">
        <button id="width-100" class="active">100%</button>
        <button id="width-500">500px</button>
        <button id="width-fit">fit-content</button>
      </div>
      <div class="header-menu">
        <button id="debug-toggle" class="active">Debug</button>
      </div>
    </div>

    <h2>基本（デフォルト: 100px/秒）</h2>
    <loop-scroll>
      <div class="item">Item 1</div>
      <div class="item">Item 2</div>
      <div class="item">Item 3</div>
      <div class="item">Item 4</div>
      <div class="item">Item 5</div>
    </loop-scroll>

    <h2>速度指定（200px/秒）</h2>
    <loop-scroll speed="200">
      <div class="item">Fast 1</div>
      <div class="item">Fast 2</div>
      <div class="item">Fast 3</div>
    </loop-scroll>

    <h2>逆方向（-100px/秒）</h2>
    <loop-scroll speed="-100">
      <div class="item">Reverse 1</div>
      <div class="item">Reverse 2</div>
      <div class="item">Reverse 3</div>
      <div class="item">Reverse 4</div>
    </loop-scroll>

    <h2>コンテンツが少ない場合</h2>
    <loop-scroll speed="50">
      <div class="item">First</div>
      <div class="item">Second</div>
    </loop-scroll>

    <h2>コンテンツが少ない場合（充填モード）</h2>
    <loop-scroll speed="50" fill debug>
      <div class="item">First</div>
      <div class="item">Second</div>
    </loop-scroll>

    <h2>画像コンテンツ</h2>
    <loop-scroll>
      <div class="item">テキスト</div>
      <div class="item">
        <img
          src="https://picsum.photos/120/80"
          alt="sample"
          style="display: block; border-radius: 4px"
        />
      </div>
      <div class="item">短い</div>
      <div class="item">
        <img
          src="https://picsum.photos/80/80"
          alt="square"
          style="display: block; border-radius: 4px"
        />
      </div>
    </loop-scroll>

    <h2>動的コンテンツ</h2>
    <loop-scroll>
      <div class="item">Static</div>
      <div class="item" id="dynamic-item">Loading...</div>
      <div class="item">Static</div>
    </loop-scroll>

    <h2>クリックイベント</h2>
    <loop-scroll>
      <button class="item" onclick="alert(1)">Button 1</button>
      <button class="item" onclick="alert(2)">Button 2</button>
      <button class="item" onclick="alert(3)">Button 3</button>
    </loop-scroll>

    <h2>クリックイベント（充填モード）</h2>
    <loop-scroll fill>
      <button class="item" onclick="alert(1)">Button 1</button>
      <button class="item" onclick="alert(2)">Button 2</button>
    </loop-scroll>

    <script>
      // 幅を切り替える
      function setLoopWidth(width) {
        document.documentElement.style.setProperty("--loop-width", width);

        // ボタンのactive状態を更新
        document
          .getElementById("width-100")
          .classList.toggle("active", width === "100%");
        document
          .getElementById("width-500")
          .classList.toggle("active", width === "500px");
        document
          .getElementById("width-fit")
          .classList.toggle("active", width === "fit-content");
      }

      // 幅切り替えボタン
      document
        .getElementById("width-100")
        .addEventListener("click", () => setLoopWidth("100%"));
      document
        .getElementById("width-500")
        .addEventListener("click", () => setLoopWidth("500px"));
      document
        .getElementById("width-fit")
        .addEventListener("click", () => setLoopWidth("fit-content"));

      // デバッグモードトグル
      document.getElementById("debug-toggle").addEventListener("click", (e) => {
        document.body.classList.toggle("debug");
        e.target.classList.toggle("active");
      });

      // 3秒後に動的にテキストを設定
      setTimeout(() => {
        const dynamicItem = document.getElementById("dynamic-item");
        if (dynamicItem) {
          dynamicItem.textContent =
            "これはAPIから取得した長いテキストです。動的に設定されます。";
        }
      }, 3000);
    </script>
  </body>
</html>
